(function(e){var n=null;var r="",s="";var o=this;var u=false;var a=false;var f=null;var c=new Array;var h=new Array;var p=0;var d=false;var v=new Array;e.fn.bgStretcher=function(o){function u(i){if(!o.images.length){return}c(i);s="#"+o.imageContainer;n=e(s);r="#"+o.imageContainer+" LI";e(r).hide().css({"z-index":1,overflow:"hidden"});if(!n.length){return}e(window).resize(function(){a(i)});a(i);var u=0;if(o.transitionEffect=="simpleSlide"){if(o.sequenceMode=="random"){if(typeof console!=="undefined"&&console!=null){console.log("Effect 'simpleSlide' don't be to use with mode random.");console.log("Mode was automaticly set in normal.")}}e(r).css({"float":"left",position:"static"});e(r).show();if(e.fn.bgStretcher.settings.slideDirection=="NW"||e.fn.bgStretcher.settings.slideDirection=="NE"){e.fn.bgStretcher.settings.slideDirection="N"}if(e.fn.bgStretcher.settings.slideDirection=="SW"||e.fn.bgStretcher.settings.slideDirection=="SE"){e.fn.bgStretcher.settings.slideDirection="S"}if(e.fn.bgStretcher.settings.slideDirection=="S"||e.fn.bgStretcher.settings.slideDirection=="E"){o.sequenceMode="back";e(r).removeClass("bgs-current");e(r).eq(e(r).length-e.fn.bgStretcher.settings.startElementIndex-1).addClass("bgs-current");if(e.fn.bgStretcher.settings.slideDirection=="E"){l=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).width()*-1;t=0}else{t=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).height()*-1;l=0}e(s+" UL").css({left:l+"px",top:t+"px"})}else{o.sequenceMode="normal";if(e.fn.bgStretcher.settings.startElementIndex!=0){if(e.fn.bgStretcher.settings.slideDirection=="N"){t=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).height()*-1;l=0}else{l=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).width()*-1;t=0;console.log(l)}e(s+" UL").css({left:l+"px",top:t+"px"})}}}if(e(o.buttonNext).length||e(o.buttonPrev).length||e(o.pagination).length){if(o.sequenceMode=="random"){if(typeof console!=="undefined"&&console!=null){console.log("Don't use random mode width prev-button, next-button and pagination.")}}else{if(e(o.buttonPrev).length){e(o.buttonPrev).addClass("bgStretcherNav bgStretcherNavPrev");e(o.buttonPrev).click(function(){e.fn.bgStretcher.buttonSlide("prev")})}if(e(o.buttonNext).length){e(o.buttonNext).addClass("bgStretcherNav bgStretcherNavNext");e(o.buttonNext).click(function(){e.fn.bgStretcher.buttonSlide("next")})}if(e(o.pagination).length){e.fn.bgStretcher.pagination()}}}if(o.sequenceMode=="random"){var h=Math.floor(Math.random()*e(r).length);e.fn.bgStretcher.buildRandom(h);if(o.transitionEffect!="simpleSlide"){e.fn.bgStretcher.settings.startElementIndex=h}u=h}else{if(e.fn.bgStretcher.settings.startElementIndex>e(r).length-1)e.fn.bgStretcher.settings.startElementIndex=0;u=e.fn.bgStretcher.settings.startElementIndex;if(o.transitionEffect=="simpleSlide"){if(e.fn.bgStretcher.settings.slideDirection=="S"||e.fn.bgStretcher.settings.slideDirection=="E"){u=e(r).length-1-e.fn.bgStretcher.settings.startElementIndex}}}e(r).eq(u).show().addClass("bgs-current");e.fn.bgStretcher.loadImg(e(r).eq(u));if(o.slideShow&&e(r).length>1){f=setTimeout("$.fn.bgStretcher.slideShow('"+e.fn.bgStretcher.settings.sequenceMode+"', -1)",o.nextSlideDelay)}}function a(i){var u=0;var a=0;var f=0;var c=0;if(e("BODY").hasClass("bgStretcher-container")){u=e(window).width();a=e(window).height();if(e.browser.msie&&parseInt(jQuery.browser.version)==6){e(window).scroll(function(){e("#"+o.imageContainer).css("top",e(window).scrollTop())})}}else{e(".bgstretcher").css("position","absolute").css("top","0px");u=i.width();a=i.height()}var h=0,p=0;var d=0;if(o.maxWidth!="auto"){if(u>o.maxWidth){d=(u-o.maxWidth)/2;c=o.maxWidth}else c=u}else c=u;if(o.maxHeight!="auto"){if(a>o.maxHeight){f=o.maxHeight}else f=a}else f=a;n.width(c);n.height(f);if(!o.resizeProportionally){h=f;p=f}else{var m=o.imageWidth,g=o.imageHeight;var y=g/m;h=c;p=Math.round(c*y);if(p<f){p=f;h=Math.round(p/y)}}var b=0;var w=0;var E;if(e.fn.bgStretcher.settings.anchoring!="left top"){E=e.fn.bgStretcher.settings.anchoring.split(" ");if(E[0]=="right"){b=u-c}else{if(E[0]=="center")b=Math.round((u-c)/2)}if(E[1]=="bottom"){w=a-f}else{if(E[1]=="center"){w=Math.round((a-f)/2)}}n.css("marginLeft",b+"px").css("marginTop",w+"px")}b=0;w=0;if(e.fn.bgStretcher.settings.anchoringImg!="left top"){E=e.fn.bgStretcher.settings.anchoringImg.split(" ");if(E[0]=="right"){b=c-h}else{if(E[0]=="center")b=Math.round((c-h)/2)}if(E[1]=="bottom"){w=f-p}else{if(E[1]=="center"){w=Math.round((f-p)/2)}}}v["mar_left"]=b;v["mar_top"]=w;if(n.find("LI:first").hasClass("swf-mode")){var S=n.find("LI:first").html();n.find("LI:first").html('<div id="bgstretcher-flash">Â </div>');var x=new SWFObject("flash/stars.swf","flash-obj",c,f,"9");x.addParam("wmode","transparent");x.write("bgstretcher-flash")}v["imgW"]=h;v["imgH"]=p;if(!o.resizeAnimate){n.children("UL").children("LI.img-loaded").find("IMG").css({marginLeft:v["mar_left"]+"px",marginTop:v["mar_top"]+"px"});n.children("UL").children("LI.img-loaded").find("IMG").css({width:v["imgW"]+"px",height:v["imgH"]+"px"})}else{n.children("UL").children("LI.img-loaded").find("IMG").animate({marginLeft:v["mar_left"]+"px",marginTop:v["mar_top"]+"px"},"normal");n.children("UL").children("LI.img-loaded").find("IMG").animate({width:v["imgW"]+"px",height:v["imgH"]+"px"},"normal")}e(r).width(n.width()).height(n.height());if(e.fn.bgStretcher.settings.transitionEffect=="simpleSlide"){if(e.fn.bgStretcher.settings.slideDirection=="W"||e.fn.bgStretcher.settings.slideDirection=="E"){n.children("UL").width(n.width()*e(r).length).height(n.height());if(e(s+" LI").index(e(s+" LI.bgs-current"))!=-1){l=e(s+" LI").index(e(s+" LI.bgs-current"))*n.width()*-1;n.children("UL").css({left:l+"px"})}}else{n.children("UL").height(n.height()*e(r).length).width(n.width());if(e(s+" LI").index(e(s+" LI.bgs-current"))!=-1){t=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).height()*-1;n.children("UL").css({top:t+"px"})}}}}function c(t){var n="";var r;t.each(function(){e(this).wrapInner('<div class="bgstretcher-page" />').wrapInner('<div class="bgstretcher-area" />');n='<div id="'+o.imageContainer+'" class="bgstretcher"><ul>';if(o.images.length){var t=o.images[0].split(".");t=t[t.length-1];if(t!="swf"){var s=0;for(i=0;i<o.images.length;i++){if(o.transitionEffect=="simpleSlide"&&o.sequenceMode=="back")s=o.images.length-1-i;else s=i;if(e.fn.bgStretcher.settings.preloadImg){n+='<li><span class="image-path">'+o.images[s]+"</span></li>"}else{n+='<li class="img-loaded"><img src="'+o.images[s]+'" alt="" /></li>'}}}else{n+='<li class="swf-mode">'+o.images[0]+"</li>"}}n+="</ul></div>";r=e(this).children(".bgstretcher-area");e(n).prependTo(r);r.css({position:"relative"});r.children(".bgstretcher-page").css({position:"relative","z-index":3})})}if(e(".bgstretcher-page").length||e(".bgstretcher-area").length){if(typeof console!=="undefined"&&console!=null)console.log("More than one bgStretcher");return false}o=e.extend({},e.fn.bgStretcher.defaults,o);e.fn.bgStretcher.settings=o;this.addClass("bgStretcher-container");u(this)};e.fn.bgStretcher.loadImg=function(t){if(t.hasClass("img-loaded"))return true;t.find("SPAN.image-path").each(function(){var t=e(this).html();var n="";var r=e(this).parent();var i=new Image;e(i).load(function(){e(this).hide();r.prepend(this);e(this).fadeIn("100")}).error(function(){}).attr("src",t).attr("alt",n);e(i).css({marginLeft:v["mar_left"]+"px",marginTop:v["mar_top"]+"px"});e(i).css({width:v["imgW"]+"px",height:v["imgH"]+"px"})});t.addClass("img-loaded");return true};e.fn.bgStretcher.play=function(){u=false;e.fn.bgStretcher._clearTimeout();e.fn.bgStretcher.slideShow(e.fn.bgStretcher.settings.sequenceMode,-1)};e.fn.bgStretcher._clearTimeout=function(){if(f!=null){clearTimeout(f);f=null}};e.fn.bgStretcher.pause=function(){u=true;e.fn.bgStretcher._clearTimeout()};e.fn.bgStretcher.sliderDestroy=function(){var t=e(".bgstretcher-page").html();e(".bgStretcher-container").html("").html(t).removeClass("bgStretcher-container");e.fn.bgStretcher._clearTimeout();u=false};e.fn.bgStretcher.slideShow=function(t,n){a=true;if(e(r).length<2)return true;var i=e(s+" LI.bgs-current");var o;if(n==-1){switch(t){case"back":o=i.prev();if(!o.length){o=e(s+" LI:last")}break;case"random":if(p==e(s+" LI").length){e.fn.bgStretcher.buildRandom(c[e(s+" LI").length-1]);p=0}o=e(s+" LI").eq(c[p]);p++;break;default:o=i.next();if(!o.length){o=e(s+" LI:first")}}}else{o=e(s+" LI").eq(n)}e(s+" LI").removeClass("bgs-current");e.fn.bgStretcher.loadImg(o);o.addClass("bgs-current");switch(e.fn.bgStretcher.settings.transitionEffect){case"fade":e.fn.bgStretcher.effectFade(i,o);break;case"simpleSlide":e.fn.bgStretcher.simpleSlide();break;case"superSlide":e.fn.bgStretcher.superSlide(i,o,t);break;default:e.fn.bgStretcher.effectNone(i,o)}if(e(e.fn.bgStretcher.settings.pagination).find("LI").length){e(e.fn.bgStretcher.settings.pagination).find("LI.showPage").removeClass("showPage");e(e.fn.bgStretcher.settings.pagination).find("LI").eq(e(s+" LI").index(e(s+" LI.bgs-current"))).addClass("showPage")}if(e.fn.bgStretcher.settings.callbackfunction){if(typeof e.fn.bgStretcher.settings.callbackfunction=="function")e.fn.bgStretcher.settings.callbackfunction.call()}if(!u){f=setTimeout("$.fn.bgStretcher.slideShow('"+e.fn.bgStretcher.settings.sequenceMode+"', -1)",e.fn.bgStretcher.settings.nextSlideDelay)}};e.fn.bgStretcher.effectNone=function(e,t){t.show();e.hide();a=false};e.fn.bgStretcher.effectFade=function(t,n){n.fadeIn(e.fn.bgStretcher.settings.slideShowSpeed);t.fadeOut(e.fn.bgStretcher.settings.slideShowSpeed,function(){a=false})};e.fn.bgStretcher.simpleSlide=function(){var t,n;switch(e.fn.bgStretcher.settings.slideDirection){case"N":case"S":t=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).height()*-1;n=0;break;default:n=e(s+" LI").index(e(s+" LI.bgs-current"))*e(s).width()*-1;t=0}e(s+" UL").animate({left:n+"px",top:t+"px"},e.fn.bgStretcher.settings.slideShowSpeed,function(){a=false})};e.fn.bgStretcher.superSlide=function(t,n,r){var i,o;switch(e.fn.bgStretcher.settings.slideDirection){case"S":i=e(s).height();o=0;break;case"E":i=0;o=e(s).width();break;case"W":i=0;o=e(s).width()*-1;break;case"NW":i=e(s).height()*-1;o=e(s).width()*-1;break;case"NE":i=e(s).height()*-1;o=e(s).width();break;case"SW":i=e(s).height();o=e(s).width()*-1;break;case"SE":i=e(s).height();o=e(s).width();break;default:i=e(s).height()*-1;o=0}if(r=="back"){n.css({"z-index":2,top:i+"px",left:o+"px"});n.show();n.animate({left:"0px",top:"0px"},e.fn.bgStretcher.settings.slideShowSpeed,function(){t.hide();e(this).css({"z-index":1});a=false})}else{t.css("z-index",2);n.show();t.animate({left:o+"px",top:i+"px"},e.fn.bgStretcher.settings.slideShowSpeed,function(){e(this).hide().css({"z-index":1,top:"0px",left:"0px"});a=false})}};e.fn.bgStretcher.buildRandom=function(t){var n=e(r).length;var i,s,o;for(i=0;i<n;i++){c[i]=i;h[i]=Math.random()*n}for(i=0;i<n;i++){for(s=0;s<n-i-1;s++){if(h[s]>h[s+1]){o=h[s];h[s]=h[s+1];h[s+1]=o;o=c[s];c[s]=c[s+1];c[s+1]=o}}}if(c[0]==t){o=c[0];c[0]=c[n-1];c[n-1]=o}};e.fn.bgStretcher.buttonSlide=function(t){if(a||e(r).length<2)return false;var n="";if(t=="prev"){n="back";if(e.fn.bgStretcher.settings.sequenceMode=="back")n="normal"}else{n=e.fn.bgStretcher.settings.sequenceMode}e(r).stop(true,true);e.fn.bgStretcher._clearTimeout();e.fn.bgStretcher.slideShow(n,-1);return false};e.fn.bgStretcher.pagination=function(){var t=e(r).length;var n="";var i=0;if(t>0){n+="<ul>";for(i=0;i<t;i++){n+='<li><a href="javascript:;">'+(i+1)+"</a></li>"}n+="</ul>";e(e.fn.bgStretcher.settings.pagination).html(n);e(e.fn.bgStretcher.settings.pagination).find("LI:first").addClass("showPage");e(e.fn.bgStretcher.settings.pagination).find("A").click(function(){if(e(this).parent().hasClass("showPage"))return false;e(r).stop(true,true);e.fn.bgStretcher._clearTimeout();e.fn.bgStretcher.slideShow(e.fn.bgStretcher.settings.sequenceMode,e(e.fn.bgStretcher.settings.pagination).find("A").index(e(this)));return false})}return false};e.fn.bgStretcher.defaults={imageContainer:"bgstretcher",resizeProportionally:true,resizeAnimate:false,images:[],imageWidth:1024,imageHeight:768,maxWidth:"auto",maxHeight:"auto",nextSlideDelay:3e3,slideShowSpeed:"normal",slideShow:true,transitionEffect:"fade",slideDirection:"N",sequenceMode:"normal",buttonPrev:"",buttonNext:"",pagination:"",anchoring:"left top",anchoringImg:"left top",preloadImg:false,startElementIndex:0,callbackfunction:null};e.fn.bgStretcher.settings={}})(jQuery)